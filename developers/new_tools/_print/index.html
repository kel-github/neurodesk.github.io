<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.90.1">
<link rel=canonical type=text/html href=https://kel-github/neurodesk.github.io/developers/new_tools/>
<link rel=alternate type=application/rss+xml href=https://kel-github/neurodesk.github.io/developers/new_tools/index.xml>
<meta name=robots content="noindex, nofollow">
<link rel="shortcut icon" href=/neurodesk.github.io/favicons/favicon.ico>
<link rel=apple-touch-icon href=/neurodesk.github.io/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/neurodesk.github.io/favicons/android-192x192.png sizes=192x192>
<title>How to add new tools | NeuroDesk</title>
<meta name=description content="How to add new tools to neurodesk
">
<meta property="og:title" content="How to add new tools">
<meta property="og:description" content="How to add new tools to neurodesk
">
<meta property="og:type" content="website">
<meta property="og:url" content="https://kel-github/neurodesk.github.io/developers/new_tools/"><meta property="og:site_name" content="NeuroDesk">
<meta itemprop=name content="How to add new tools">
<meta itemprop=description content="How to add new tools to neurodesk
"><meta name=twitter:card content="summary">
<meta name=twitter:title content="How to add new tools">
<meta name=twitter:description content="How to add new tools to neurodesk
">
<link rel=preload href=/neurodesk.github.io/scss/main.min.73d5be94f5e99c5a61460fa5b435757ce8ab87f13970655d157965b5df2b9419.css as=style>
<link href=/neurodesk.github.io/scss/main.min.73d5be94f5e99c5a61460fa5b435757ce8ab87f13970655d157965b5df2b9419.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script>
<link rel=stylesheet href=/neurodesk.github.io/css/prism.css>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-00000000-0','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/neurodesk.github.io/>
<span class=navbar-logo></span><span class="text-uppercase font-weight-bold">NeuroDesk</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/neurodesk.github.io/docs/><span>Documentation</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/neurodesk.github.io/applications/><span>Applications</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/neurodesk.github.io/developers/><span class=active>Developers</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/neurodesk.github.io/tutorials/><span>Tutorials</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://github.com/NeuroDesk target=_blank><i class="fab fa-github"></i><span>GitHub</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://twitter.com/neuro_desk target=_blank><i class="fab fa-twitter"></i><span>News/Twitter</span></a>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/neurodesk.github.io/offline-search-index.91c85f396fda7116b0ecc82bd2e05ae1.json data-offline-search-base-href=/ data-offline-search-max-results=10>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.
</p><p>
<a href=/neurodesk.github.io/developers/new_tools/>Return to the regular view of this page</a>.
</p>
</div>
<h1 class=title>How to add new tools</h1>
<div class=lead>How to add new tools to neurodesk</div>
<ul>
<li>1: <a href=#pg-e24a02244ddbf4a83fcf0095e3003590>Add tools</a></li>
<li>2: <a href=#pg-f706aedba5bc93ee895c966642b91365>Menu entries</a></li>
</ul>
<div class=content>
</div>
</div>
<div class=td-content>
<h1 id=pg-e24a02244ddbf4a83fcf0095e3003590>1 - Add tools</h1>
<div class=lead>Add a tool to neurodesktop</div>
<p>The goal of <em>neurodesk</em> is to provide users with a large choice of tools to use in their pipelines.
Use the guide below to add a tool to <em>neurodesktop</em> or <em>neurocontainers</em>.</p>
<h2 id=guiding-principles>Guiding principles</h2>
<p>To decide if a tool should be packaged in a singularity container in <em>neurocontainers</em> or be installed in the <em>neurodesktop</em> container we are currently following these guiding principles:</p>
<ol>
<li><em>neurodesk</em> is not a package manager. This means we are not distributing tools in containers that can easily be installed via a standard package manager</li>
<li><em>neurodesk</em> allows users to have multiple versions of tools in parallel via <a href=https://lmod.readthedocs.io/en/latest/>lmod</a>, this means that if different versions of a tool can&rsquo;t be installed in parallel we package the tool inside a container.</li>
<li><em>neurodesk</em> aims to provide tooling to link tools from different containers (such as workflow managers like nipype or nextflow). This means that if a tool is required to coordinate various container-tools, it should be in the <em>neurodesktop</em> container.</li>
</ol>
<p>Examples:</p>
<table>
<thead>
<tr>
<th></th>
<th>easy install</th>
<th>coordinates containers</th>
<th>small in size</th>
<th>latest version is ok</th>
<th>useful to most users</th>
<th>Conclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td>git</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>lmod</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>nipype</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>vscode</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>itksnap</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>container?</td>
</tr>
<tr>
<td>convert3D</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
<tr>
<td>fsl</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
<tr>
<td>mrtrix</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
<tr>
<td>freesurfer</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
</tbody>
</table>
<h2 id=adding-new-recipes>Adding new recipes</h2>
<p>Refer to <a href=https://github.com/NeuroDesk/neurodocker>neurodocker</a> for more information on neurodocker recipes</p>
<h2 id=build-container>Build container</h2>
<p>To build a container, set up environment with:</p>
<ol>
<li>Docker, the version in our CI environment</li>
<li>Python, the version in our CI environment</li>
</ol>
<p>And then follow these steps:</p>
<ol>
<li>Sync/modify Neurodocker, the dependency we are using to build containers:
<ol>
<li>Press &ldquo;Fetch upstream&rdquo; in <a href=https://github.com/NeuroDesk/neurodocker>https://github.com/NeuroDesk/neurodocker</a> to check if our fork of Neurodocker is already up-to-date</li>
<li>If there are upstream commits that are not synced yet, open an issue in <a href=https://github.com/NeuroDesk/neurocontainers/issues>https://github.com/NeuroDesk/neurocontainers/issues</a>, requesting one of Neurodesk admins to pull-in latest changes from Neurodocker upstream into our fork of Neurodocker</li>
<li>If relevant to your project, add recipe to neurodocker (<a href=https://github.com/NeuroDesk/neurodocker>https://github.com/NeuroDesk/neurodocker</a>) and create a pull request to neurodocker (add new tool in a branch!)</li>
</ol>
</li>
<li>Clone the neurocontainers repository:
<div class="alert alert-primary" role=alert>
<p>Optional: Fork neurocontainers and setup github actions</p>
<ol>
<li>Fork <a href=https://github.com/NeuroDesk/neurocontainers>https://github.com/NeuroDesk/neurocontainers</a> into your account.</li>
<li>Go to your neurocontainers fork.</li>
<li>If Actions tab is missing, go to Settings > Actions. Select Allow all actions. Then Save.</li>
<li>In the actions tab, select &ldquo;I understand my workflows, go ahead and enable them&rdquo;</li>
</ol>
<p>Pushes to the recipes in your fork will now trigger actions to build the respective docker container, and push them to your Github Packages.</p>
</div>
</li>
</ol>
<p><a href=https://github.com/NeuroDesk/neurocontainers>https://github.com/NeuroDesk/neurocontainers</a></p>
<pre class="language-shell command-line" data-prompt=$><code>git clone https://github.com/NeuroDesk/neurocontainers/</code></pre>
<ol start=3>
<li>Copy the directory template and rename to <em>newapp</em> in <code>neurocontainers/recipes</code></li>
</ol>
<pre class="language-shell command-line" data-prompt=$><code>cd neurocontainers/recipes
cp -R template newapp</code></pre>
<ol start=4>
<li>Modify <code>build.sh</code> in <code>neurocontainers/recipes/newapp</code> to build your application and update README.md (make sure the version is correct in the README!)</li>
</ol>
<pre class="language-shell command-line" data-prompt=$ data-output=2-3><code>cd newapp
(edit build.sh as required)
(edit README.md as required)</code></pre>
<p>Upload your application to object storage first if needed, so you can then download it in build.sh (ask for instructions about this if you don&rsquo;t know the key, and never share it anywhere public!)</p>
<ol start=5>
<li>Run update-builders.sh - This will auto-create the CI workflow for the application (or manually duplicate the template file and rename all occurances of template to <em>newapp</em>)</li>
</ol>
<pre class="language-shell command-line" data-prompt=$><code>cd ../..
sh update-builders.sh</code></pre>
<blockquote>
<p>if the CI build runs out of space, add the application to the following txt to add additional space.
<a href=https://github.com/NeuroDesk/neurocontainers/blob/master/.github/workflows/free-up-space-list.txt>https://github.com/NeuroDesk/neurocontainers/blob/master/.github/workflows/free-up-space-list.txt</a>.
Note this, significantly increases CI run time, only use in cases of space errors.</p>
</blockquote>
<ol start=6>
<li>
<p>Build and test the container locally</p>
<ol>
<li>clone our fork of Neurodocker: git clone <a href=https://github.com/NeuroDesk/neurodocker/>https://github.com/NeuroDesk/neurodocker/</a></li>
<li>install neurodocker: cd neurodocker; python -m pip install .</li>
<li>run the build script with the &ndash;debug flag: <a href=https://github.com/NeuroDesk/neurocontainers/blob/master/recipes/lcmodel/build.sh>https://github.com/NeuroDesk/neurocontainers/blob/master/recipes/lcmodel/build.sh</a></li>
</ol>
<pre class="language-shell command-line" data-prompt=$><code>chmod +x build.sh
./build.sh -debug</code></pre>
<ol start=4>
<li>test running some commands within the container that should be available in your local docker container repository</li>
<li>if your application requires a Matlab Runtime and you get an error about shared library &ldquo;libmwlaunchermain.so&rdquo; not found, check which version of the runtime was installed by the build script</li>
</ol>
</li>
<li>
<p>Update changes in local git repository</p>
</li>
</ol>
<pre class="language-shell command-line" data-prompt=$><code>git add recipes/newapp/build.sh recipes/newapp/README.md .github/workflows/newapp.yml
git config user.email "the email that you use for github"
git config user.name "your name"
git commit</code></pre>
<ol start=8>
<li>Generate git personal access token (if you don’t have one already)</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>Browse to https://github.com/NeuroDesk/neurocontainers/
Press on your picture in upper right corner --&gt; Setting --&gt; Developer Settings --&gt; Personal Access Token
Press on “generate personal access token”
Write something in “Notes” (doesn’t matter what, it’s for your own use)
Check “repo”
Check “Workflow”
Press “Generate Token” at the bottom
Copy the token displayed on the screen into a file, so you’ll have it later
</code></pre></div><ol start=9>
<li>Test the container locally, and if successful push repo to trigger the automatic build on GitHub</li>
</ol>
<pre class="language-shell command-line" data-prompt=$><code>git pull
git push</code></pre>
<ol start=10>
<li>
<p>Go to neurocontainers/actions. Check that the most recent workflow run in the list terminated successfully (green). Otherwise, click on it, click on “build docker”, and the line that caused the error will be highlighted</p>
</li>
<li>
<p>Find your new package under <a href="https://github.com/orgs/NeuroDesk/packages?repo_name=neurocontainers">https://github.com/orgs/NeuroDesk/packages?repo_name=neurocontainers</a></p>
<p>Enter the name of the package in the search box, and verify that the full package name shows up in the format <em>toolName_toolVersion</em></p>
</li>
<li>
<p>Obtain <em>buildDate</em> by clicking on the full package name that came up in the search. The build date will be the newest date shown under <strong>Recent tagged image versions</strong></p>
</li>
<li>
<p>Use <em>toolName</em>, <em>toolVersion</em> and <em>buildDate</em> from the previous two steps to manually download the package by typing the following in a terminal open in Neurodesktop</p>
</li>
</ol>
<pre class="language-shell command-line" data-prompt=$><code>bash /neurocommand/local/fetch_and_run.sh toolName toolVersion buildDate
ml toolName/toolVersion</code></pre>
<p>For example:
If the full package name that comes up in the step 11 is itksnap_3.8.0, and the newest date under <strong>Recent tagged image versions</strong> is 20210322</p>
<p>The command to use in a terminal open in Neurodesktop is:</p>
<pre class="language-shell command-line" data-prompt=$><code>bash /neurocommand/local/fetch_and_run.sh itksnap 3.8.0 20210322
ml toolName/toolVersion</code></pre>
<div class="alert alert-warning" role=alert>
<h4 class=alert-heading>Depreciation notice</h4>
<p>For VNM users use:</p>
<pre class="language-shell command-line" data-prompt=$><code>bash /neurodesk/local/fetch_and_run.sh toolName toolVersion buildDate
ml toolName/toolVersion</code></pre>
</div>
<ol start=14>
<li>
<p>Test the new container. Run some commands, to see all is good</p>
</li>
<li>
<p>Fork <a href=https://github.com/NeuroDesk/neurocommand/>https://github.com/NeuroDesk/neurocommand/</a> to your Github account</p>
</li>
<li>
<p>Edit an entry for your package in your fork of neurocommand/blob/main/neurodesk/apps.json based on one of the other entries (generating one menu item for opening a terminal inside the containers, and one menu item for the GUI, if relevant). Notice that in the json file, the version field should contain the <em>buildDate</em></p>
</li>
<li>
<p>Include an icon file in your fork of neurocommand/tree/main/neurodesk/icons</p>
</li>
<li>
<p>Send a pull request from your fork of neurocommand to <a href=https://github.com/NeuroDesk/neurocommand/>https://github.com/NeuroDesk/neurocommand/</a></p>
</li>
<li>
<p>When the pull request is merged by Neurodesk admins, it will trigger an action to build the singularity container, distribute it in all object storage locations and on CVMFS, and it will update the menus in the desktop image on the next daily build</p>
</li>
<li>
<p>Check in the dev build if everything is ok before releasing a new version of Neurodesktop:</p>
</li>
</ol>
<pre class="language-shell command-line" data-prompt=$><code>sudo docker pull vnmd/neurodesktop-dev:latest && sudo docker run   --shm-size=1gb -it --privileged --name neurodesktop   -v ~/neurodesktop-storage:/neurodesktop-storage   -e HOST_UID="$(id -u)" -e HOST_GID="$(id -g)"   -p 8080:8080 -h neurodesktop-dev   vnmd/neurodesktop-dev:latest</code></pre>
<ol start=21>
<li>Consider contributing a tutorial about the new tool: <a href=https://github.com/NeuroDesk/neurodesk.github.io/tree/hugo-docsy/content/en/tutorials>https://github.com/NeuroDesk/neurodesk.github.io/tree/hugo-docsy/content/en/tutorials</a></li>
</ol>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-f706aedba5bc93ee895c966642b91365>2 - Menu entries</h1>
<div class=lead>Menu entries in neurodesktop</div>
<h2 id=menu-entry>Menu entry</h2>
<p>As we want to propose several versions of the tools, each piece of software should have its own submenu under <code>VNM Neuroimaging</code>.
To do so, you first have to add a submenu to <code>menus/vnm-applications.menu</code> by adding:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#8f5902;font-style:italic>&lt;!-- [[Tool Name]] submenu --&gt;</span>
<span style=color:#204a87;font-weight:700>&lt;Menu&gt;</span>
    <span style=color:#204a87;font-weight:700>&lt;Name&gt;</span>[[Tool Name]]<span style=color:#204a87;font-weight:700>&lt;/Name&gt;</span>
    <span style=color:#204a87;font-weight:700>&lt;Directory&gt;</span>vnm-[[tool-name]].directory<span style=color:#204a87;font-weight:700>&lt;/Directory&gt;</span>
    <span style=color:#204a87;font-weight:700>&lt;Include&gt;</span>
        <span style=color:#204a87;font-weight:700>&lt;And&gt;</span>
            <span style=color:#204a87;font-weight:700>&lt;Category&gt;</span>[[Tool-Name]]<span style=color:#204a87;font-weight:700>&lt;/Category&gt;</span>
        <span style=color:#204a87;font-weight:700>&lt;/And&gt;</span>
    <span style=color:#204a87;font-weight:700>&lt;/Include&gt;</span>
<span style=color:#204a87;font-weight:700>&lt;/Menu&gt;</span> <span style=color:#8f5902;font-style:italic>&lt;!-- End [[Tool Name]] --&gt;</span>
</code></pre></div><p>The following table shows the formatting rules to follow:</p>
<table>
<thead>
<tr>
<th>Placeholder</th>
<th>Rule</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[[Tool name]]</code></td>
<td>Capitalized, spaces</td>
<td><code>ITK snap</code></td>
</tr>
<tr>
<td><code>[[tool-name]]</code></td>
<td>Lower case, no spaces (use <code>-</code> instead)</td>
<td><code>itk-snap</code> or <code>itksnap</code></td>
</tr>
<tr>
<td><code>[[Tool-name]]</code></td>
<td>Capitalized, no spaces (use <code>-</code> instead)</td>
<td><code>ITK-snap</code></td>
</tr>
</tbody>
</table>
<p>Next, we have to create the submenu itself as we referenced it by <code>vnm-[[tool-name]].directory</code>. To do so, create the file <code>menus/submenus/vnm-[[tool-name]].directory</code> and add the following information inside:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#204a87;font-weight:700>[Desktop Entry]</span>
<span style=color:#c4a000>Name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>[[Tool Name]]</span>
<span style=color:#c4a000>Comment</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>[[Tool Name]]</span>
<span style=color:#c4a000>Icon</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>/home/neuro/.config/lxpanel/LXDE/icons/[[icon-name]].png</span>
<span style=color:#c4a000>Type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>Directory</span>
</code></pre></div><p>If a specific icon is available in the <code>menus/icons</code> directory, replace <code>[[icon-name]]</code> by its name. Otherwise, use <code>vnm</code>.</p>
<h2 id=create-the-application>Create the application</h2>
<p>Finally, we have to create the actual application by creating the file <code>menus/applications/vnm-[[tool-name]]-[[0.0.0]].desktop</code>. The name of this file must contain the version of the tool (once again to allow multiple versions to live inside the same directory). Add the following description to this file:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#204a87;font-weight:700>[Desktop Entry]</span>
<span style=color:#c4a000>Name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>[[Tool Name]] [[0.0.0]] [[(Install only)]]</span>
<span style=color:#c4a000>GenericName</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>[[Tool Name]] [[0.0.0]]</span>
<span style=color:#c4a000>Comment</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>The description of what clicking on this application does. # This will be the tooltip of the application.</span>
<span style=color:#c4a000>Exec</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>The command used to run the application.</span>
<span style=color:#c4a000>Icon</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>/home/neuro/.config/lxpanel/LXDE/icons/[[icon-name]].png</span>
<span style=color:#c4a000>Type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>Application</span>
<span style=color:#c4a000>Categories</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>[[Tool-name]]</span>
<span style=color:#c4a000>Terminal</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>true # or false</span>
</code></pre></div><p>The important part here is the value of <code>Exec</code>. If the tool is in the form of a singularity image, you should run the following command:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>bash /usr/share/fetch_and_run.sh <span style=color:#ce5c00;font-weight:700>[[</span>tool-name<span style=color:#ce5c00;font-weight:700>]]</span> <span style=color:#ce5c00;font-weight:700>[[</span>0.0.0<span style=color:#ce5c00;font-weight:700>]]</span> <span style=color:#ce5c00;font-weight:700>[[</span>YYYYMMDD<span style=color:#ce5c00;font-weight:700>]]</span> <span style=color:#ce5c00;font-weight:700>[[</span>cmd<span style=color:#ce5c00;font-weight:700>]]</span> <span style=color:#ce5c00;font-weight:700>[[</span>args<span style=color:#ce5c00;font-weight:700>]]</span>
</code></pre></div><p>What <code>fetch_and_run.sh</code> does is check if the image is already installed as a module. If not, it checks whether it can be installed or not (return <code>1</code> if not possible). After that, it installs the image as a module.
If <code>[[cmd]]</code> is specified, once the image is installed, it runs the command by giving the arguments from <code>[[args]]</code>.
Here are two examples for FreeSurfer and FreeView. This first one only installs the image as a module:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>bash /usr/share/fetch_and_run.sh freesurfer 6.0.1 <span style=color:#0000cf;font-weight:700>20200506</span>
</code></pre></div><p>And this does the same but runs FreeView afterward:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>bash /usr/share/fetch_and_run.sh freesurfer 6.0.1 <span style=color:#0000cf;font-weight:700>20200506</span> freeview
</code></pre></div><p>The resulting <code>.desktop</code> file corresponding to FreeView contains:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#204a87;font-weight:700>[Desktop Entry]</span>
<span style=color:#c4a000>Name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>FreeView 6.0.1</span>
<span style=color:#c4a000>GenericName</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>FreeView 6.0.1</span>
<span style=color:#c4a000>Comment</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>Start FreeView 6.0.1</span>
<span style=color:#c4a000>Exec</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>bash /usr/share/fetch_and_run.sh freesurfer 6.0.1 20200506 freeview</span>
<span style=color:#c4a000>Icon</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>/home/neuro/.config/lxpanel/LXDE/icons/run.png</span>
<span style=color:#c4a000>Type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>Application</span>
<span style=color:#c4a000>Categories</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>FreeSurfer</span>
<span style=color:#c4a000>Terminal</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>true</span>
</code></pre></div>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label>
<a class=text-white target=_blank rel=noopener href aria-label>
<i></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank rel=noopener href=https://twitter.com/neuro_desk aria-label=Twitter>
<i class="fab fa-twitter"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label>
<a class=text-white target=_blank rel=noopener href aria-label>
<i></i>
</a>
</li>
</ul>
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label>
<a class=text-white target=_blank rel=noopener href aria-label>
<i></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dicussion Forum (requires github login)" aria-label="Dicussion Forum (requires github login)">
<a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk/neurodesk.github.io/discussions aria-label="Dicussion Forum (requires github login)">
<i class="fa fa-envelope"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/neurodesk.github.io/js/tabpane-persist.js></script>
<script src=/neurodesk.github.io/js/main.min.3a75d46404b4b4835d9009c79b684ebaec265268791fa90da61c67d7d208378c.js integrity="sha256-OnXUZAS0tINdkAnHm2hOuuwmUmh5H6kNphxn19IIN4w=" crossorigin=anonymous></script>
<script src=/neurodesk.github.io/js/prism.js></script>
</body>
</html>